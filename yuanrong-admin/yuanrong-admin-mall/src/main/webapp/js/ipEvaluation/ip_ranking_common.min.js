$(document).ready(function(){var ipCategoryListDom=$("#js-ip-category-list"),timeSelectDom=$("#js-time-range"),rankType=$(".on").data("id"),moreBtnDom=$("#js-more-btn"),listName="",listConWrapDom=$("#js-list-con-wrap"),cp=1,rows=50;function getCategoryList(){var postUrl=newDomain+"/dictInfo/getDictInfoByType";ipCategoryListDom.html(""),commonFun.commonAjax(postUrl,"post",{type:13},function(res){var categoryArr=res.data;if(1==res.status){for(var categoryHtml="",i=0,len=categoryArr.length;i<len;i++)categoryHtml+='<li data-id="'+categoryArr[i].id+'"><a>'+categoryArr[i].name+"</a></li>";ipCategoryListDom.append(categoryHtml),ipCategoryListDom.find("li").eq(0).addClass("ca-active"),$("li",ipCategoryListDom).off("click").on("click",function(){var $this=$(this);console.log($this),$this.addClass("ca-active").siblings().removeClass("ca-active"),getData(cp,$(".ca-active").find("a").text(),timeSelectDom.val(),rankType)})}getData(cp,$(".ca-active").find("a").text(),timeSelectDom.val(),rankType)},function(error){getData(cp,$(".ca-active").find("a").text(),timeSelectDom.val(),rankType),console.log(error)})}function getTimeList(listName){var postUrl=newDomain+"/baseRank/selectRangeTime";timeSelectDom.html(""),commonFun.commonAjax(postUrl,"post",{typeName:listName},function(res){console.log(res);var timeArr=res.data;if(1==res.status){for(var timeHtml="",i=0,len=timeArr.length;i<len;i++)timeHtml+='<option value="'+timeArr[i]+'">'+timeArr[i]+"</option>";timeSelectDom.append(timeHtml)}getCategoryList()},function(error){console.log(error),getCategoryList()})}function getData(cp,name,time,type){if(1==type){var postUrl=newDomain+"/listArticle/selectAllListArticle";$(".list_content").html("")}else if(2==type){var postUrl=newDomain+"/listIPCreativity/selectAllListIPCreativity";listConWrapDom.html("")}var noDataWrapDom=$("#js-no-data-wrap"),noOneImg='<img src="/images/ipEvaluation/ipRanking/no_1.png" alt="">',noTwoImg='<img src="/images/ipEvaluation/ipRanking/no_2.png" alt="">',noThreeImg='<img src="/images/ipEvaluation/ipRanking/no_3.png" alt="">',pData={cp:cp,rows:rows,typeName:name,rangeTime:time};commonFun.commonAjax(postUrl,"post",pData,function(res){if(1==res.status){var sucData=res.data;if(sucData.total<=cp*rows?$(".more_btn").hide():$(".more_btn").show(),sucData.data&&sucData.data.length){var sucDataList=sucData.data,sucDataListLen=sucDataList.length;if(1==type){var list_content=$(".list_content");sucDataList.forEach(function(item,index){var num=index+1+(cp-1)*rows,noImg="";noImg=1==num?noOneImg:2==num?noTwoImg:3==num?noThreeImg:num,$('<ul><li class="title"><span>'+noImg+'</span><a target="_blank" href="'+item.Link+'">'+item.Title+"</a></li><li>"+item.Theme+"</li><li>"+item.Creativity+"</li><li>"+item.Originality+"</li><li>"+item.TotalIndex+"</li></ul>").appendTo(list_content)})}else if(2==type)for(var j=0;j<sucDataListLen;j++){var noImg="",id=j+1+(cp-1)*rows,html='<ul class="fixedClear"><li class="li-width42">'+(noImg=1==id?noOneImg:2==id?noTwoImg:3==id?noThreeImg:id)+'</li><li class="fixedClear li-width203"><div class="ip-avatar-wrap"><img class="ip-avatar-img" src="'+sucDataList[j].HeadImg+'" alt=""></div><div class="ip-name-wrap"><p class="ip-name-cn">'+sucDataList[j].Name+'</p><p class="ip-name-en">'+sucDataList[j].weixinId+"</p></div></li><li>"+sucDataList[j].ContentQuality+"</li><li>"+sucDataList[j].Stability+"</li><li>"+sucDataList[j].Transmissible+"</li><li>"+sucDataList[j].OriginalProportion+"</li><li>"+sucDataList[j].TotalIndex+"</li></ul>";listConWrapDom.append(html);var listUlDom,listUlDOmLen=listConWrapDom.find("ul").length;if(listUlDOmLen)for(var i=0;i<listUlDOmLen;i++)listConWrapDom.find("ul:odd").addClass("ul-gray")}}else noDataWrapDom.show(),moreBtnDom.hide()}else noDataWrapDom.show(),moreBtnDom.hide()})}function calcHeight(){var footerHei=$(".footer-wrap").height(),winHei,contentHei=$(window).height()-footerHei-158;$(".content").css("min-height",contentHei+"px")}1==rankType?listName="listArticle":2==rankType&&(listName="listIPCreativity"),getTimeList(listName),timeSelectDom.on("change",function(){var $this=$(this);getData(cp,$(".ca-active").find("a").text(),timeSelectDom.val(),rankType)}),moreBtnDom.off("click").on("click",function(){getData(++cp,$(".ca-active").find("a").text(),timeSelectDom.val(),rankType)}),calcHeight(),$(window).resize(function(){calcHeight()})});